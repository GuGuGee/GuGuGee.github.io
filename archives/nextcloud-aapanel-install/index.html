<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>【好玩的项目】可能是史上最全的基于宝塔面板（海外版aapanel）的Nextcloud网盘搭建教程！ | 我不是咕咕鸽</title><meta name="author" content="咕咕鸽"><meta name="copyright" content="咕咕鸽"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="介绍Nextcloud是一款开源免费的私有云存储网盘项目，可以让你快速便捷地搭建一套属于自己或团队的云同步网盘，从而实现跨平台跨设备文件同步、共享、版本控制、团队协作等功能。它的客户端覆盖了Windows、Mac、Android、iOS、Linux 等各种平台，也提供了网页端以及 WebDAV接口，所以你几乎可以在各种设备上方便地访问你的云盘。 今天我们从零开始来搭建一个Nextcloud网盘，">
<meta property="og:type" content="article">
<meta property="og:title" content="【好玩的项目】可能是史上最全的基于宝塔面板（海外版aapanel）的Nextcloud网盘搭建教程！">
<meta property="og:url" content="https://blog.laoda.de/archives/nextcloud-aapanel-install/index.html">
<meta property="og:site_name" content="我不是咕咕鸽">
<meta property="og:description" content="介绍Nextcloud是一款开源免费的私有云存储网盘项目，可以让你快速便捷地搭建一套属于自己或团队的云同步网盘，从而实现跨平台跨设备文件同步、共享、版本控制、团队协作等功能。它的客户端覆盖了Windows、Mac、Android、iOS、Linux 等各种平台，也提供了网页端以及 WebDAV接口，所以你几乎可以在各种设备上方便地访问你的云盘。 今天我们从零开始来搭建一个Nextcloud网盘，">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img.laoda.de/i/2022/05/02/dzx54l_7.webp">
<meta property="article:published_time" content="2022-03-06T08:45:27.547Z">
<meta property="article:modified_time" content="2022-04-13T08:20:59.507Z">
<meta property="article:author" content="咕咕鸽">
<meta property="article:tag" content="Nextcloud">
<meta property="article:tag" content="aapanel">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.laoda.de/i/2022/05/02/dzx54l_7.webp"><link rel="shortcut icon" href="https://img.laoda.de/i/2023/07/13/2dcwxy-0.webp"><link rel="canonical" href="https://blog.laoda.de/archives/nextcloud-aapanel-install/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: '8920495929686095',
  enable_page_level_ads: 'true'
});</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":50,"position":"top","messagePrev":"本文自上次更新已经过了","messageNext":"天，若内容或图片失效，请留言反馈。"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '【好玩的项目】可能是史上最全的基于宝塔面板（海外版aapanel）的Nextcloud网盘搭建教程！',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-04-13 16:20:59'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><script async src="https://analytics.laoda.de/script.js" data-website-id="e631177f-7024-44bb-bcc4-5de70d00a512"></script><script defer data-domain="blog.laoda.de" src="https://plausible.laoda.de/js/script.js"></script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="我不是咕咕鸽" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://img.laoda.de/i/2023/07/13/2dcwxy-0.webp" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">223</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">420</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/vps"><i class="fa-fw fas fa-cart-shopping"></i><span> 高性价比VPS</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener external nofollow noreferrer" href="https://vps.laoda.de/"><i class="fa-fw fas fa-bell"></i><span> VPS库存监控</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener external nofollow noreferrer" href="https://news.laoda.de/"><i class="fa-fw fas fa-bell"></i><span> VPS最新资讯</span></a></div><div class="menus_item"><a class="site-page" href="/comments"><i class="fa-fw fas fa-comment"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/buy-me-a-coffee"><i class="fa-fw fas fa-coffee"></i><span> 咖啡名单</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-fire"></i><span> VPS推荐</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/%E7%BE%8E%E5%9B%BDVPS/"><i class="fa-fw fas fa-thumbs-up"></i><span> 美国VPS推荐</span></a></li><li><a class="site-page child" href="/tags/%E6%AC%A7%E6%B4%B2VPS/"><i class="fa-fw fas fa-thumbs-up"></i><span> 欧洲VPS推荐</span></a></li><li><a class="site-page child" href="/tags/%E4%BA%9A%E5%A4%AAVPS/"><i class="fa-fw fas fa-thumbs-up"></i><span> 亚太VPS推荐</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-flask"></i><span> 实验室</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://uptime.laoda.de/status/1"><i class="fa-fw fas fa-clock"></i><span> 服务监控</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://analytics.laoda.de/share/wRDUxpPMzC79ThGK/%E5%B0%8F%E9%B8%BD%E5%AD%90"><i class="fa-fw fas fa-chart-pie"></i><span> 网站流量</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://status.laoda.de/"><i class="fa-fw fas fa-cloud"></i><span> 咕咕的小鸡们</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-archive"></i><span> 文章归档</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/VPS%E6%8E%A8%E8%8D%90/"><i class="fa-fw fas fa-cloud"></i><span> VPS系列</span></a></li><li><a class="site-page child" href="/categories/Docker%E7%B3%BB%E5%88%97/"><i class="fa-fw fas fa-fire-flame-curved"></i><span> Docker系列</span></a></li><li><a class="site-page child" href="/categories/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF/"><i class="fa-fw fas fa-shield"></i><span> 宝塔面板系列</span></a></li><li><a class="site-page child" href="/categories/Docker%E7%B3%BB%E5%88%97/%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/"><i class="fa-fw fas fa-note-sticky"></i><span> 网站搭建系列</span></a></li><li><a class="site-page child" href="/categories/%E6%9C%89%E7%94%A8%E7%9A%84%E5%B0%8F%E7%9F%A5%E8%AF%86/"><i class="fa-fw fas fa-lightbulb"></i><span> 有用的小知识</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> 更多</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 文章标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 文章分类</span></a></li><li><a class="site-page child" href="/sitemap.xml"><i class="fa-fw fas fa-sitemap"></i><span> 站点地图</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://img.gugu.ovh"><i class="fa-fw fas fa-image"></i><span> 公益图床</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于咕咕</span></a></li><li><a class="site-page child" href="/atom.xml"><i class="fa-fw fas fa-rss"></i><span> RSS订阅</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://img.laoda.de/i/2022/05/02/dzx54l_7.webp')"><nav id="nav"><span id="blog-info"><a href="/" title="我不是咕咕鸽"><img class="site-icon" src="https://img.laoda.de/i/2023/07/13/2dcwxy-0.webp"/><span class="site-name">我不是咕咕鸽</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/vps"><i class="fa-fw fas fa-cart-shopping"></i><span> 高性价比VPS</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener external nofollow noreferrer" href="https://vps.laoda.de/"><i class="fa-fw fas fa-bell"></i><span> VPS库存监控</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener external nofollow noreferrer" href="https://news.laoda.de/"><i class="fa-fw fas fa-bell"></i><span> VPS最新资讯</span></a></div><div class="menus_item"><a class="site-page" href="/comments"><i class="fa-fw fas fa-comment"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/buy-me-a-coffee"><i class="fa-fw fas fa-coffee"></i><span> 咖啡名单</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-fire"></i><span> VPS推荐</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/%E7%BE%8E%E5%9B%BDVPS/"><i class="fa-fw fas fa-thumbs-up"></i><span> 美国VPS推荐</span></a></li><li><a class="site-page child" href="/tags/%E6%AC%A7%E6%B4%B2VPS/"><i class="fa-fw fas fa-thumbs-up"></i><span> 欧洲VPS推荐</span></a></li><li><a class="site-page child" href="/tags/%E4%BA%9A%E5%A4%AAVPS/"><i class="fa-fw fas fa-thumbs-up"></i><span> 亚太VPS推荐</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-flask"></i><span> 实验室</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://uptime.laoda.de/status/1"><i class="fa-fw fas fa-clock"></i><span> 服务监控</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://analytics.laoda.de/share/wRDUxpPMzC79ThGK/%E5%B0%8F%E9%B8%BD%E5%AD%90"><i class="fa-fw fas fa-chart-pie"></i><span> 网站流量</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://status.laoda.de/"><i class="fa-fw fas fa-cloud"></i><span> 咕咕的小鸡们</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-archive"></i><span> 文章归档</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/VPS%E6%8E%A8%E8%8D%90/"><i class="fa-fw fas fa-cloud"></i><span> VPS系列</span></a></li><li><a class="site-page child" href="/categories/Docker%E7%B3%BB%E5%88%97/"><i class="fa-fw fas fa-fire-flame-curved"></i><span> Docker系列</span></a></li><li><a class="site-page child" href="/categories/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF/"><i class="fa-fw fas fa-shield"></i><span> 宝塔面板系列</span></a></li><li><a class="site-page child" href="/categories/Docker%E7%B3%BB%E5%88%97/%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/"><i class="fa-fw fas fa-note-sticky"></i><span> 网站搭建系列</span></a></li><li><a class="site-page child" href="/categories/%E6%9C%89%E7%94%A8%E7%9A%84%E5%B0%8F%E7%9F%A5%E8%AF%86/"><i class="fa-fw fas fa-lightbulb"></i><span> 有用的小知识</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> 更多</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 文章标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 文章分类</span></a></li><li><a class="site-page child" href="/sitemap.xml"><i class="fa-fw fas fa-sitemap"></i><span> 站点地图</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://img.gugu.ovh"><i class="fa-fw fas fa-image"></i><span> 公益图床</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于咕咕</span></a></li><li><a class="site-page child" href="/atom.xml"><i class="fa-fw fas fa-rss"></i><span> RSS订阅</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">【好玩的项目】可能是史上最全的基于宝塔面板（海外版aapanel）的Nextcloud网盘搭建教程！</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-03-06T08:45:27.547Z" title="发表于 2022-03-06 16:45:27">2022-03-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-04-13T08:20:59.507Z" title="更新于 2022-04-13 16:20:59">2022-04-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF/">宝塔面板</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>15分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="【好玩的项目】可能是史上最全的基于宝塔面板（海外版aapanel）的Nextcloud网盘搭建教程！"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><img src="https://pic.loll.cc/images/2022/03/06/202203061124799.png" alt="image-20220306112428686"></p>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>Nextcloud是一款开源免费的私有云存储网盘项目，可以让你快速便捷地搭建一套属于自己或团队的云同步网盘，从而实现跨平台跨设备文件同步、共享、版本控制、团队协作等功能。它的客户端覆盖了Windows、Mac、Android、iOS、Linux 等各种平台，也提供了网页端以及 WebDAV接口，所以你几乎可以在各种设备上方便地访问你的云盘。</p>
<p>今天我们从零开始来搭建一个Nextcloud网盘，搭建其实很简单，所以也会多介绍一些搭建完成之后，<strong>安全与设置警告</strong>报错信息的解决方法。</p>
<h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><ul>
<li>功能丰富，社区生态丰富</li>
<li>遇到问题容易在网上找到解决方案</li>
<li>高速（直链下载速度起飞，与服务器带宽有关）</li>
<li>私密（自己全权管理所有文件）</li>
<li>稳定（不存在服务商关闭网盘服务的问题）</li>
<li>实现了PC、iPhone、iPad三端自动同步</li>
<li>可以直接编辑云端的文件（代码文件也直接查看编辑）</li>
</ul>
<h3 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>不够轻量，而且比较吃服务器资源（内存等），服务器的硬盘容量通常不大（多为几十G，不适合做仓库盘）</li>
<li>后续配置比较复杂私有云盘需要自己维护（出现各种问题就很糟心）</li>
</ul>
<p>之前搭建的网盘：<a href="https://blog.laoda.de/archives/cloudreve-install">告别百度网盘，安装自己的专属网盘——Cloudreve，不限制下载速度！</a></p>
<h2 id="1-项目展示"><a href="#1-项目展示" class="headerlink" title="1. 项目展示"></a>1. 项目展示</h2><p>GitHub项目地址：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/nextcloud">https://github.com/nextcloud</a></p>
<p>Demo：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://try.nextcloud.com/">https://try.nextcloud.com</a></p>
<h2 id="2-搭建环境"><a href="#2-搭建环境" class="headerlink" title="2. 搭建环境"></a>2. 搭建环境</h2><ul>
<li>服务器：腾讯香港轻量应用服务器24元&#x2F;月VPS一台（最好是选非大陆的服务器）（<a target="_blank" rel="noopener external nofollow noreferrer" href="https://loll.cc/tx">购买链接</a>）</li>
<li>系统：Debian 10（<a href="https://blog.laoda.de/archives/useful-script#dd%E7%9B%B8%E5%85%B3">DD脚本</a> 非必需DD用原来的系统也OK）</li>
<li>域名一枚，并做好解析到服务器上（<a href="https://blog.laoda.de/archives/namesilo">域名购买、域名解析</a> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bilibili.com/video/BV1Sy4y1k7kZ/">视频教程</a>）</li>
<li>【非必需】安装好Docker、Docker-compose（<a href="https://blog.laoda.de/archives/hello-docker#5%E5%AE%89%E8%A3%85dockerdocker-compose">相关脚本</a>）</li>
<li>安装好宝塔面板海外版本aapanel，并安装好Nginx（<a target="_blank" rel="noopener external nofollow noreferrer" href="https://forum.aapanel.com/d/9-aapanel-linux-panel-6812-installation-tutorial">安装地址</a>）</li>
<li>【非必需】安装好Nginx Proxy Manager（<a href="https://blog.laoda.de/archives/nginxproxymanager">相关教程</a>）</li>
</ul>
<h2 id="3-搭建视频"><a href="#3-搭建视频" class="headerlink" title="3. 搭建视频"></a>3. 搭建视频</h2><p>YouTube：待补充</p>
<p>哔哩哔哩：待补充(心态发生了问题，自己已经安装好了，演示视频的时候安装一直提示“内部服务器错误”，搜索了很多内容，依旧无法解决，玄学 &#x3D;，&#x3D;)</p>
<h2 id="4-搭建方式"><a href="#4-搭建方式" class="headerlink" title="4. 搭建方式"></a>4. 搭建方式</h2><p>参考——<a href="https://blog.laoda.de/archives/vps-script"><strong>新买了一台服务器“必须”要做的6件小事:</strong></a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt update -y  <span class="comment"># 升级packages</span></span><br><span class="line"></span><br><span class="line">apt install wget  <span class="comment">#如果出现 wget:command not found,可以用这个命令安装</span></span><br></pre></td></tr></table></figure>



<p>Debian宝塔海外版安装命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -O install.sh http://www.aapanel.com/script/install-ubuntu_6.0_en.sh &amp;&amp; bash install.sh forum</span><br></pre></td></tr></table></figure>



<blockquote>
<p> 遇到访问不了的情况，请在宝塔面板的防火墙和服务商的后台防火墙里打开对应端口。</p>
</blockquote>
<p>在选择安装LNMP过程中，可以先去把域名解析到服务器上先～</p>
<p>等待半小时左右，LNMP基本都能安装完成。</p>
<p>Nextcloud官方下载地址：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://nextcloud.com/install/#instructions-server">https://nextcloud.com/install/#instructions-server</a></p>
<img src="https://pic.loll.cc/images/2022/03/06/202203061243957.png" alt="image-20220306124301857" style="zoom:50%;" />



<h2 id="5-开始搭建（以宝塔安装为例子）"><a href="#5-开始搭建（以宝塔安装为例子）" class="headerlink" title="5. 开始搭建（以宝塔安装为例子）"></a>5. 开始搭建（以宝塔安装为例子）</h2><p>Docker搭建参考：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/nextcloud/docker/blob/master/.examples/docker-compose/insecure/postgres/fpm/docker-compose.yml">https://github.com/nextcloud/docker/blob/master/.examples/docker-compose/insecure/postgres/fpm/docker-compose.yml</a></p>
<p>不是很推荐用Docker搭建，因为Nextcloud后续配置会</p>
<img src="https://pic.loll.cc/images/2022/03/06/202203061638134.png" alt="image-20220306163844059" style="zoom:50%;" />



<p>远程下载：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://download.nextcloud.com/server/releases/nextcloud-23.0.2.zip">https://download.nextcloud.com/server/releases/nextcloud-23.0.2.zip</a></p>
<p><img src="https://pic.loll.cc/images/2022/03/06/202203061639443.png" alt="image-20220306163952402"></p>
<p>修改权限：宝塔面板——文件——找到<code>/www/wwwroot</code>路径，将Nextcloud整个网站目录的权限由755修改为775（不设置打开网址会报“内部服务器错误”的问题）</p>
<h2 id="6-安全与设置警告排错（重点，适用于宝塔面板）"><a href="#6-安全与设置警告排错（重点，适用于宝塔面板）" class="headerlink" title="6. 安全与设置警告排错（重点，适用于宝塔面板）"></a>6. 安全与设置警告排错（重点，适用于宝塔面板）</h2><h3 id="6-1-Nextcloud性能优化"><a href="#6-1-Nextcloud性能优化" class="headerlink" title="6.1 Nextcloud性能优化"></a>6.1 Nextcloud性能优化</h3><h4 id="6-1-1-使用APCu和Redis内存缓存"><a href="#6-1-1-使用APCu和Redis内存缓存" class="headerlink" title="6.1.1 使用APCu和Redis内存缓存"></a>6.1.1 使用APCu和Redis内存缓存</h4><p>通过使用内存作为数据缓存的话，可以提高Nextcloud的性能，以加快访问速度，并且Nextcloud支持多个内存缓存后端，如<code>APCu</code>、<code>Redis</code>，其他的缓存后端配置请参阅：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.nextcloud.com/server/18/admin_manual/configuration_server/caching_configuration.html">Nextcloud内存缓存优化的官方文档</a></p>
<p><strong>[1] 安装PHP的APCu+Redis扩展</strong></p>
<p>在宝塔面板的首页处，找到PHP并点开，在安装扩展处安装<code>redis</code>和<code>apcu</code>。</p>
<p><strong>[2] 配置APCu和Redis</strong></p>
<p>安装完毕后，打开<code>/www/wwwroot/域名/config/config.php</code>，在其尾部添加以下代码：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;memcache.local&#x27;</span> =&gt; <span class="string">&#x27;\OC\Memcache\APCu&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;memcache.distributed&#x27;</span> =&gt; <span class="string">&#x27;\OC\Memcache\Redis&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;redis&#x27;</span> =&gt; [</span><br><span class="line">	<span class="string">&#x27;host&#x27;</span> =&gt; <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">	<span class="string">&#x27;port&#x27;</span> =&gt; <span class="number">6379</span>,</span><br><span class="line">],</span><br><span class="line"><span class="string">&#x27;memcache.locking&#x27;</span> =&gt; <span class="string">&#x27;\OC\Memcache\Redis&#x27;</span>,</span><br></pre></td></tr></table></figure>

<h4 id="6-1-2-开启PHP-OPcache"><a href="#6-1-2-开启PHP-OPcache" class="headerlink" title="6.1.2 开启PHP OPcache"></a>6.1.2 开启PHP OPcache</h4><p>通过安装<code>OPcache</code>扩展，也可以在一定程度上提升PHP的性能。</p>
<p>在宝塔面板的首页处，找到PHP并点开，在安装扩展处安装<code>OPcache</code>。</p>
<h4 id="6-1-3-官方推荐的PHP扩展"><a href="#6-1-3-官方推荐的PHP扩展" class="headerlink" title="6.1.3 官方推荐的PHP扩展"></a>6.1.3 官方推荐的PHP扩展</h4><p>官方推荐的其他PHP扩展：<code>fileinfo</code>，<code>gmp</code>，<code>imagick</code>，安装完上述扩展及设置后，重载PHP配置并重启PHP服务。</p>
<p>咕咕在自己的Netcup上出现了gmp扩展模块安装不上的情况，参考了宝塔论坛的教程，</p>
<blockquote>
<p>该问题是因为操作系统未安装libgmp3-dev软件包导致，建议宝塔的自动安装脚本修复该问题，自动检测这个软件包的状态和自动安装该软件包。</p>
</blockquote>
<p>具体命令是：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt install libgmp3-dev -y</span><br></pre></td></tr></table></figure>

<p>之后再到php这边点击gmp模块安装，就能安装成功了。</p>
<h4 id="6-1-4-文件扫描"><a href="#6-1-4-文件扫描" class="headerlink" title="6.1.4 文件扫描"></a>6.1.4 文件扫描</h4><p>有时候，我们直接使用Linux命令，如：<code>wget</code>、<code>curl</code>等命令直接下载文件到服务器内Nextcloud里的用户目录，但是用户登录Nextcloud却并没有显示，怎么办？<br>我们可以使用PHP配合Nextcloud命令，来自动扫描文件：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -u www php occ files:scan --all</span><br><span class="line">Copy</span><br></pre></td></tr></table></figure>

<p>其中：</p>
<ul>
<li>命令使用需要在Nextcloud根目录下</li>
<li>需要使用<code>sudo -u</code>命令提权到www用户（即：Nginx用户）</li>
</ul>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/scanFile.png"><img src="https://imagehost.mintimate.cn/post_deployNextcloud/scanFile.png" alt="扫描文件夹"></a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/scanFile.png">扫描文件夹</a></p>
<h4 id="6-1-5-后台任务优化"><a href="#6-1-5-后台任务优化" class="headerlink" title="6.1.5 后台任务优化"></a>6.1.5 后台任务优化</h4><p>Nextcloud的后台任务，默认是使用Ajax异步方法进行后台任务，即在每次访问Nextcloud任意页面都会通过<code>AJAX</code>的方式发起定时任务的执行请求，这种方式如果没有自己的独立服务器或者VPS的话还是比较方便省心的，但官方推荐使用<code>Cron</code>，<strong>和Nginx或Apache等WEB服务独立开来，互不影响</strong>：</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/q5qzv6zkk2.png"><img src="https://imagehost.mintimate.cn/post_deployNextcloud/q5qzv6zkk2.png" alt="后台任务"></a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/q5qzv6zkk2.png">后台任务</a></p>
<p>为了使用Cron，我们需要用到Linux的定时任务。<br>SSH连接服务器后，输入：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure>

<p>创建一个Cron任务，并使用正则表达式：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">*/5 * * * * sudo -u www php /PathToNextcloud/cron.php</span><br></pre></td></tr></table></figure>

<p>保存即可。</p>
<p>当然，如果你用宝塔面板，也可以直接使用宝塔自带的控制面板，设置定时任务：<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/25emmnrggo.png"><img src="https://imagehost.mintimate.cn/post_deployNextcloud/25emmnrggo.png" alt="宝塔设置定时任务"></a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/25emmnrggo.png">宝塔设置定时任务</a></p>
<h3 id="6-2-安全及设置警告问题排查"><a href="#6-2-安全及设置警告问题排查" class="headerlink" title="6.2 安全及设置警告问题排查"></a>6.2 安全及设置警告问题排查</h3><p>打开Nextcloud的<code>设置</code>——<code>概览</code>——<code>安全及设置警告</code>，可以看到检测出的一些问题，下面我们将对其逐一排查解决。</p>
<blockquote>
<p><strong>[1] PHP 的安装似乎不正确，无法访问系统环境变量。getenv(“PATH”) 函数测试返回了一个空值。</strong></p>
</blockquote>
<p>宝塔面板——首页的PHP——FPM配置文件，在其尾部添加一行：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">env[PATH] = /usr/local/bin:/usr/bin:/bin:/usr/local/php/bin</span><br></pre></td></tr></table></figure>

<p>注：该配置文件的位置为<code>/www/server/php/php版本号/etc/php-fpm.conf</code></p>
<blockquote>
<p><strong>[2] 您的网页服务器未正确设置以解析“&#x2F;.well-known&#x2F;caldav”、“&#x2F;.well-known&#x2F;carddav、&#x2F;.well-known&#x2F;webfinger、&#x2F;.well-known&#x2F;nodeinfo”</strong></p>
</blockquote>
<p><code>宝塔面板</code>——<code>网站</code>——<code>设置</code>——<code>配置文件</code>，在server里添加如下两行：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">rewrite /.well-known/carddav /remote.php/dav permanent;</span><br><span class="line">rewrite /.well-known/caldav /remote.php/dav permanent;</span><br></pre></td></tr></table></figure>

<p>打开伪静态，加入这段：</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="section">location</span> = /.well-known/webfinger &#123;</span><br><span class="line">     <span class="attribute">return</span> <span class="number">301</span> <span class="variable">$scheme</span>://<span class="variable">$host</span>:<span class="variable">$server_port</span>/index.php/.well-known/webfinger;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="section">location</span> = /.well-known/nodeinfo &#123;</span><br><span class="line">    <span class="attribute">return</span> <span class="number">301</span> <span class="variable">$scheme</span>://<span class="variable">$host</span>:<span class="variable">$server_port</span>/index.php/.well-known/nodeinfo;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>之后保存即可。</p>
<blockquote>
<p><strong>[3] 数据库中的一些列由于进行长整型转换而缺失。由于在较大的数据表重改变列类型会耗费一些时间，因此程序没有自动对其更改。</strong></p>
</blockquote>
<p>Step1：临时修改一下config.php的权限，然后切换到occ的目录下（即<code>cd /www/wwwroot/域名</code>)</p>
<p>Step2：执行以下命令即可：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo -u www php occ db:convert-filecache-bigint</span><br></pre></td></tr></table></figure>





<blockquote>
<p><strong>[4] HTTP的请求头 “Strict-Transport-Security” 未设置为至少 “15552000” 秒. 为了提高安全性，建议启用HSTS</strong></p>
</blockquote>
<p><code>宝塔面板</code>—— <code>网站</code>——<code>文件</code>——找到<code>/www/server/panel/vhost/nginx/yourdomain.conf</code>文件——在末尾的<code>‘&#125;’</code>前加入如下代码：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">add_header Strict-Transport-Security <span class="string">&quot;max-age=15768000;preload;&quot;</span>;</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>[5] PHP configuration option output_buffering must be disabled</strong></p>
</blockquote>
<p>宝塔面板——首页的PHP——配置文件——搜索“output_buffering”，在默认配置<code>output_buffering = 4096</code>前加个分号（php的注释）</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">;output_buffering = <span class="number">4096</span></span><br></pre></td></tr></table></figure>



<h3 id="6-3-Nextcloud常见问题"><a href="#6-3-Nextcloud常见问题" class="headerlink" title="6.3 Nextcloud常见问题"></a>6.3 Nextcloud常见问题</h3><h4 id="6-3-1-解决大文件上传问题"><a href="#6-3-1-解决大文件上传问题" class="headerlink" title="6.3.1 解决大文件上传问题"></a>6.3.1 解决大文件上传问题</h4><p><strong>Step1：修改php.ini上传文件大小限制</strong></p>
<p>宝塔面板——文件——打开<code>/www/server/php/PHP版本号/etc</code>路径——打开<code>php.ini</code>文件，搜索修改以下配置：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">max_execution_time = 0     <span class="comment">#默认是300秒，改为0，表示没有上传时间限制</span></span><br><span class="line">post_max_size = 10800M     <span class="comment">#设定POST数据所允许的最大大小</span></span><br><span class="line">upload_max_filesize = 10240M  <span class="comment">#表示所上传的文件的最大大小</span></span><br></pre></td></tr></table></figure>

<p><strong>Step2：修改nginx.conf的文件大小限制</strong></p>
<p>宝塔面板——文件——打开<code>/www/server/nginx/conf/</code>路径——打开<code>nginx.conf</code>，修改的内容如下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">client_max_body_size 10240M;</span><br></pre></td></tr></table></figure>

<p><strong>Step3：修改连接超时时间限制（同步大文件时可能会超过默认的60s连接超时时间，导致连接关闭。报错为：Connection closed）</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">keepalive_timeout 3600;</span><br></pre></td></tr></table></figure>



<p><strong>Step4：重启php和nginx服务，然后进行测试，大文件可以成功上传了。</strong></p>
<h4 id="6-3-2-解决同步时423错误的问题"><a href="#6-3-2-解决同步时423错误的问题" class="headerlink" title="6.3.2 解决同步时423错误的问题"></a>6.3.2 解决同步时423错误的问题</h4><blockquote>
<p>问题描述：使用Nextcloud同步资料时，意外遇到了423错误，文件被锁定，怎么都传不上去。</p>
</blockquote>
<p>解决办法：宝塔面板——文件——打开<code>/www/wwwroot/域名/config</code>路径，找到<code>config.php</code>文件，添加一句<code>&#39;filelocking.enabled&#39; =&gt; false,</code>即可。</p>
<h4 id="6-3-3-Nextcloud退出维护模式"><a href="#6-3-3-Nextcloud退出维护模式" class="headerlink" title="6.3.3 Nextcloud退出维护模式"></a>6.3.3 Nextcloud退出维护模式</h4><blockquote>
<p>问题描述：升级NextCloud后一直处于维护状态，无法自动解除。</p>
</blockquote>
<p>解决办法：宝塔面板——文件——打开<code>/www/wwwroot/域名/config</code>路径，找到<code>config.php</code>文件，把<code>&#39;maintenance&#39; =&gt; true</code>改为 <code>false</code>，或者<strong>直接删掉</strong>这句即可。</p>
<h2 id="7-Nextcloud基本使用"><a href="#7-Nextcloud基本使用" class="headerlink" title="7. Nextcloud基本使用"></a>7. Nextcloud基本使用</h2><h3 id="7-1-Nextcloud基本设置"><a href="#7-1-Nextcloud基本设置" class="headerlink" title="7.1 Nextcloud基本设置"></a>7.1 Nextcloud基本设置</h3><p>Chrome打开<code>https://域名</code>地址，进去之后点击头像下的设置，根据自己的习惯进行配置即可。</p>
<p><img src="https://pic.loll.cc/images/2022/03/06/202203061132074.png" alt="Nextcloud用户界面"></p>
<p>同步冲突处理：使用Everything搜索conflicted copy文件并删除（Everything可以添加书签）</p>
<h3 id="7-2-Nextcloud客户端"><a href="#7-2-Nextcloud客户端" class="headerlink" title="7.2 Nextcloud客户端"></a>7.2 Nextcloud客户端</h3><p>全平台客户端下载：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://nextcloud.com/install/#install-clients">Nextcloud官网传送门</a>（如果服务器端太老，可能会用不了新版的客户端，下载适合的版本即可）</p>
<p>客户端的使用和配置</p>
<ul>
<li>Win端：网页端授权登录，安装exe后设置开机自启、文件夹同步。</li>
<li>iOS、iPadOS端：App Store直接搜索下载Nextcloud即可（点击下面的“改用旧的登录方式”，输入服务器地址、用户名、密码）</li>
</ul>
<h3 id="7-3-Nextcloud的WebDAV功能"><a href="#7-3-Nextcloud的WebDAV功能" class="headerlink" title="7.3 Nextcloud的WebDAV功能"></a>7.3 Nextcloud的WebDAV功能</h3><p>NextCloud 支持 WebDAV 协议，用户可以完全通过 WebDAV 来连接并同步文件。虽然官方还是推荐 使用客户端来同步文件，不过如果要临时访问 NextCloud 上的文件，使用 WebDAV 方式还是很便捷的。</p>
<p>打开Nextcloud网页登录后，单击设置，复制WebDAV下的URL地址：</p>
<p><img src="https://pic.loll.cc/images/2022/03/06/202203061132745.png" alt="Nextcloud的WebDAV"></p>
<p>使用WebDAV连接时的用户名和密码就是登录Nextcloud的用户名和密码。</p>
<blockquote>
<p>注：可以用WebDAV功能给一些第三方软件实现全平台同步的功能。</p>
</blockquote>
<h2 id="8-结尾"><a href="#8-结尾" class="headerlink" title="8. 结尾"></a>8. 结尾</h2><p>祝大家用得开心，有问题可以去GitHub提<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/nextcloud">Issues</a>，也可以在评论区互相交流探讨。</p>
<p>咕咕上期还搭建了一个网盘直链程序，相比Nextcloud，它搭建更加容易（docker一条命令搞定），升级也非常简单，支持的网盘也更多，UI也非常漂亮。</p>
<p>相关代码都在博客里：<a href="https://blog.laoda.de/archives/docker-install-alist">https://blog.laoda.de/archives/docker-install-alist</a></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>好朋友的Mintimate的博客：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://mintimate.cn/2021/02/20/deployNextcloud/">https://mintimate.cn/2021/02/20/deployNextcloud/</a></p>
<p>Nextcloud 21 使用笔记 - 系统要求及警告排除：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.cnswiz.com/3376.html">https://www.cnswiz.com/3376.html</a></p>
<p>VPS搭建Nextcloud私有云盘 | Eulaの小破站：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.eula.club/VPS%E6%90%AD%E5%BB%BANextcloud%E7%A7%81%E6%9C%89%E4%BA%91%E7%9B%98.html">https://www.eula.club/VPS%E6%90%AD%E5%BB%BANextcloud%E7%A7%81%E6%9C%89%E4%BA%91%E7%9B%98.html</a></p>
<h3 id="附："><a href="#附：" class="headerlink" title="附："></a>附：</h3><h4 id="1、内部错误和警告的解决方法"><a href="#1、内部错误和警告的解决方法" class="headerlink" title="1、内部错误和警告的解决方法"></a>1、内部错误和警告的解决方法</h4><p>一些常见Nextcloud内部错误解决方法，<strong>建议使用浏览器搜索功能进行定位</strong></p>
<p><strong>1）您的安装没有设置默认的电话区域。这对验证配置设定中没有国家代码的电话号码而言是必需的。要允许没有国家代码的电话号码，请添加带区域相应的 ISO 3166-1 code ↗ 的“默认_电话_区域”到你的配置文件中。</strong></p>
<p>在网站配置文件（如：<code>/www/wwwroot/nextcloud.laoda.de/config/config.php</code>）中添加如下代码后保存即可：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;default_phone_region&#x27;</span> =&gt; <span class="string">&#x27;CN&#x27;</span>,</span><br></pre></td></tr></table></figure>

<p><img src="https://pic.loll.cc/images/2022/03/06/202203061110981.png" alt="image-20220306111019819"></p>
<p><strong>2）通过HTTP访问网站不安全。强烈建议您将服务器设置成要求使用HTTPS协议</strong></p>
<p>这个问题最好解决，同时也可能是无法解决问题：<br>服务器绑定域名，并配置SSL证书，<a target="_blank" rel="noopener external nofollow noreferrer" href="https://cloud.tencent.com/product/cns?from=10680">域名解析</a>到服务器即可<br>但是：<br><code>国内服务器需要绑定备案的域名</code>，若无备案域名，则只能使用IP访问Nextcloud，那么该条警告无法去除。</p>
<p><strong>3）一些文件没有通过完整性检查. 了解如何解决该问题请查看我们的文档. (无效的文件列表… &#x2F; 重新扫描…)</strong></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/errorFile.png"><img src="https://imagehost.mintimate.cn/post_deployNextcloud/errorFile.png" alt="无效文件"></a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/errorFile.png">无效文件</a></p>
<p>你的无效的文件列表和我的可能不一样，但是方法是一样的，打开<code>(无效的文件列表… / 重新扫描…)</code>这个链接：<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/errorFileDetail.png"><img src="https://imagehost.mintimate.cn/post_deployNextcloud/errorFileDetail.png" alt="无效文件详情">无效文件详情</a><br>上面提示的这些文件需要删除，所以打开nextcloud的安装地址，也就是Nginx所代理的网站更目录，删除“提示的无效文件“即可：<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/rmFile.png"><img src="https://imagehost.mintimate.cn/post_deployNextcloud/rmFile.png" alt="删除无效文件">删除无效文件</a><br>如果你使用宝塔面板，可以进入宝塔面板后台，然后使用宝塔的图形界面删除无效文件。如果你熟悉Linux命令，可以使用<code>rm</code>命令删除：<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/rmFile.png"><img src="https://imagehost.mintimate.cn/post_deployNextcloud/rmFile.png" alt="使用命令删除无效文件">使用命令删除无效文件</a></p>
<p><strong>4）PHP configuration option output_buffering must be disabled</strong></p>
<p>其实这个很好解决，PHP默认是有4096字节缓冲的。但是Nextcloud希望你关闭。如果你是自己安装的PHP，在你安装PHP的路径下，打开PHP配置文件（php.ini），将要</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">output_buffering = 4096</span><br><span class="line">Copy</span><br></pre></td></tr></table></figure>

<p>改为：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">; output_buffering = 4096</span><br><span class="line">Copy</span><br></pre></td></tr></table></figure>

<p><code>;</code>为PHP的注释符号<br>如果你是根据上文，使用宝塔安装配置的php，更简单了。在宝塔面板，依次打开：<code>软件商店</code>-<code>已安装</code>-<code>PHP7.3设置</code>-<code>配置文件</code><br>查找文本<code>output_buffering</code>，并在前面加上<code>;</code>注释:<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/addPhpConfig.png"><img src="https://imagehost.mintimate.cn/post_deployNextcloud/addPhpConfig.png" alt="加上注释"></a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/addPhpConfig.png">加上注释</a></p>
<p>之后，可能需要重载PHP配置或者重启PHP服务才能生效。再次查看Nextcloud概述，就没有这条警告了。</p>
<p><strong>5）您的数据目录和文件可以从互联网直接访问。.htaccess文件不起作用。强烈建议您配置Web 服务器，以便数据目录不再可访问，或者您可以将数据目录移动到 Web服务器文档根目录。</strong></p>
<p>这个其实是Nginx的问题，为了进一步提升安全性，我们打开Nginx网站设置：<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/nginxConfigInBT.png"><img src="https://imagehost.mintimate.cn/post_deployNextcloud/nginxConfigInBT.png" alt="宝塔内网站Nginx设置"></a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/nginxConfigInBT.png">宝塔内网站Nginx设置</a></p>
<p>在location内的禁止访问目录内，加入data目录。<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/addDataInNginx.png"><img src="https://imagehost.mintimate.cn/post_deployNextcloud/addDataInNginx.png" alt="加入data目录">加入data目录</a></p>
<p><strong>6）PHP 的安装似乎不正确，无法访问系统环境变量。getenv(“PATH”) 函数测试返回了一个空值</strong></p>
<p>这个处理方法很简单；如果你是自己安装配置的PHP，一般不会出现这个问题，当时如果是使用宝塔安装，一般都会有这个问题，解决方法很简单：<br>在宝塔面板，依次打开：<code>软件商店</code>-<code>已安装-PHP7.3设置</code>-<code>FPM配置文件</code><br>在文末添加：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">env[PATH] = /usr/local/bin:/usr/bin:/bin:/usr/local/php/bin</span><br><span class="line">Copy</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/addPathToPHP.png"><img src="https://imagehost.mintimate.cn/post_deployNextcloud/addPathToPHP.png" alt="添加配置"></a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/addPathToPHP.png">添加配置</a></p>
<p>之后，可能需要重载PHP配置或者重启PHP服务才能生效。</p>
<p><strong>7）您的网页服务器未正确设置以解析。更多信息请参见文档</strong></p>
<p>这个处理方法很简单，简单地说，设置Nginx即可。如果你的Nginx是宝塔安装的，那么打开网站的Nginx：<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/configNginxAgain.png"><img src="https://imagehost.mintimate.cn/post_deployNextcloud/configNginxAgain.png" alt="打开Nginx设置"></a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/configNginxAgain.png">打开Nginx设置</a></p>
<p>之后追加以下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rewrite /.well-known/carddav /remote.php/dav permanent;</span><br><span class="line">rewrite /.well-known/caldav /remote.php/dav permanent;</span><br><span class="line">Copy</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/addAtTheEnd.png"><img src="https://imagehost.mintimate.cn/post_deployNextcloud/addAtTheEnd.png" alt="追加内容"></a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/addAtTheEnd.png">追加内容</a></p>
<p>打开伪静态，加入这段：</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="section">location</span> = /.well-known/webfinger &#123;</span><br><span class="line">     <span class="attribute">return</span> <span class="number">301</span> <span class="variable">$scheme</span>://<span class="variable">$host</span>:<span class="variable">$server_port</span>/index.php/.well-known/webfinger;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="section">location</span> = /.well-known/nodeinfo &#123;</span><br><span class="line">    <span class="attribute">return</span> <span class="number">301</span> <span class="variable">$scheme</span>://<span class="variable">$host</span>:<span class="variable">$server_port</span>/index.php/.well-known/nodeinfo;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<p>之后保存即可</p>
<h4 id="2、PHP模块问题"><a href="#2、PHP模块问题" class="headerlink" title="2、PHP模块问题"></a>2、PHP模块问题</h4><p>PHP模块问题包括：</p>
<ul>
<li>未找到PHP的”fileinfo”模块。强烈推荐启用该模块，从而获得更好的MIME类型探测结果。</li>
<li>内存缓存未配置，为了提升使用体验，请尽量配置内存缓存。更多信息请参见文档。</li>
<li>PHP的OPcache模块未载入。推荐开启获得更好的性能。</li>
</ul>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/PHP.png"><img src="https://imagehost.mintimate.cn/post_deployNextcloud/PHP.png" alt="PHP模块问题"></a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/PHP.png">PHP模块问题</a></p>
<p>安装如下模块：<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/configPHP.png"><img src="https://imagehost.mintimate.cn/post_deployNextcloud/configPHP.png" alt="安装的模块-01">安装的模块-01</a><br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/configPHP00.png"><img src="https://imagehost.mintimate.cn/post_deployNextcloud/configPHP00.png" alt="安装的模块-02">安装的模块-02</a></p>
<p>咕咕在自己的Netcup上出现了gmp扩展模块安装不上的情况，参考了宝塔论坛的教程，</p>
<blockquote>
<p>该问题是因为操作系统未安装libgmp3-dev软件包导致，建议宝塔的自动安装脚本修复该问题，自动检测这个软件包的状态和自动安装该软件包。</p>
</blockquote>
<p>具体命令是：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt install libgmp3-dev -y</span><br></pre></td></tr></table></figure>

<p>之后再到php这边点击gmp模块安装，就能安装成功了。</p>
<p>同时，因为使用Redis作为缓冲，所以我们需要打开Nextcloud的配置文件，追加以下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;memcache.local&#x27; =&gt; &#x27;\OC\Memcache\Redis&#x27;,</span><br><span class="line">&#x27;redis&#x27; =&gt; array(</span><br><span class="line">  &#x27;host&#x27; =&gt; &#x27;localhost&#x27;,</span><br><span class="line">  &#x27;port&#x27; =&gt; 6379,</span><br><span class="line">  ),</span><br></pre></td></tr></table></figure>

<p><strong>1、数据库丢失了一些索引。由于给大的数据表添加索引会耗费一些时间，因此程序没有自动对其进行修复</strong></p>
<p>这个因为我之前修复了，所以我的警告和错误列表没有提示。如果你有报这条警告，直接运行：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php occ db:add-missing-indices</span><br><span class="line">Copy</span><br></pre></td></tr></table></figure>

<p>但是注意文件夹所属的用户组，比如：你Terminal上使用的是root或者Ubuntu用户，那么就需要用sudo提权</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -u php occ db:add-missing-indices</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://imagehost.mintimate.cn/post_deployNextcloud/sudo-u.png"><img src="https://imagehost.mintimate.cn/post_deployNextcloud/sudo-u.png" alt="sudo提权运行"></a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://blog.laoda.de">咕咕鸽</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.laoda.de/archives/nextcloud-aapanel-install/">https://blog.laoda.de/archives/nextcloud-aapanel-install/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.laoda.de" target="_blank">我不是咕咕鸽</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Nextcloud/">Nextcloud</a><a class="post-meta__tags" href="/tags/aapanel/">aapanel</a></div><div class="post_share"><div class="social-share" data-image="https://img.laoda.de/i/2022/05/02/dzx54l_7.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://gao.ee/wechatpay" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="https://gao.ee/wechatpay" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://gao.ee/alipay" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="https://gao.ee/alipay" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><div class="ads-wrap"><a href="/archives/vps-lcayun" target="_blank"><img src="https://img.laoda.de/i/2023/02/27/zj36hf-0.gif" style="max-width:100%; height:auto;"></a></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/archives/host-static-sites-on-npm/" title="如何在Nginx Proxy Manager（NPM）上部署静态网站"><img class="cover" src="https://img.laoda.de/i/2022/05/02/dzx54l_7.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">如何在Nginx Proxy Manager（NPM）上部署静态网站</div></div></a></div><div class="next-post pull-right"><a href="/archives/docker-install-guacamole/" title="【好玩的Docker项目】无需安装客户端！从任何地方远程访问一个或多个桌面！——部署Guacamole远程桌面网关服务"><img class="cover" src="https://img.laoda.de/i/2022/05/02/dzx54l_7.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">【好玩的Docker项目】无需安装客户端！从任何地方远程访问一个或多个桌面！——部署Guacamole远程桌面网关服务</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/archives/docker-compose-install-nextcloud-aio/" title="【好玩儿的Docker项目】Nextcloud All-in-One 全新搭建分享，拒绝繁琐配置，开箱即用！维护简单！"><img class="cover" src="https://img.laoda.de/i/2023/08/26/f9ju6v-0.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-08-26</div><div class="title">【好玩儿的Docker项目】Nextcloud All-in-One 全新搭建分享，拒绝繁琐配置，开箱即用！维护简单！</div></div></a></div><div><a href="/archives/docker-compose-install-nextcloud/" title="【好玩儿的Docker项目】可能是目前全网最完整的Docker搭建Nextcloud教程（包含安全与设置警告报错信息的解决方法）"><img class="cover" src="https://img.laoda.de/i/2022/05/02/dzx54l_7.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-01-07</div><div class="title">【好玩儿的Docker项目】可能是目前全网最完整的Docker搭建Nextcloud教程（包含安全与设置警告报错信息的解决方法）</div></div></a></div><div><a href="/archives/docker-compose-install-filerun/" title="【好玩的Docker项目】淘汰Nextcloud，一行命令搭建功能强大的个人网盘——FileRun"><img class="cover" src="https://img.laoda.de/i/2022/05/02/dzx54l_7.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-05-22</div><div class="title">【好玩的Docker项目】淘汰Nextcloud，一行命令搭建功能强大的个人网盘——FileRun</div></div></a></div><div><a href="/archives/pandownload/" title="聊一聊网盘那些事儿"><img class="cover" src="https://img.laoda.de/i/2022/05/02/dzx54l_7.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-06-19</div><div class="title">聊一聊网盘那些事儿</div></div></a></div><div><a href="/archives/hestiacp/" title="【服务器面板】自带邮件服务！宝塔面板替代品——HestiaCP 面板 保姆级教程 海外开源面板 颜值不错"><img class="cover" src="https://img.laoda.de/i/2022/05/02/dzx54l_7.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2022-06-18</div><div class="title">【服务器面板】自带邮件服务！宝塔面板替代品——HestiaCP 面板 保姆级教程 海外开源面板 颜值不错</div></div></a></div><div><a href="/archives/aapanel-install-easyimage/" title="【宝塔面板系列】10分钟搭建一个简单图床——EasyImage 简单到无需数据库！"><img class="cover" src="https://img.laoda.de/i/2022/05/02/dzx54l_7.webp" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-02-02</div><div class="title">【宝塔面板系列】10分钟搭建一个简单图床——EasyImage 简单到无需数据库！</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Waline</span><span class="switch-btn"></span><span class="second-comment">Twikoo</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://img.laoda.de/i/2023/07/13/2dcwxy-0.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">咕咕鸽</div><div class="author-info__description">服务器折腾不完全指南，定期分享一些好玩的东西，不定期记录生活。</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">223</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">420</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://t.me/laodade" rel="external nofollow noreferrer" target="_blank" title=""><i class="fab fa-telegram"></i></a><a class="social-icon" href="https://www.youtube.com/@guguge" rel="external nofollow noreferrer" target="_blank" title=""><i class="fab fa-youtube"></i></a><a class="social-icon" href="https://space.bilibili.com/19956596" rel="external nofollow noreferrer" target="_blank" title=""><i class="fas fa-tv"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title=""><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content"><div style="background-color:#F2F2F2; padding:15px; border-radius:10px; font-family:Arial, sans-serif; color:#333;"><p style="margin-bottom:10px;">如果遇到内容似乎没有更新(页面最下角<a style="color:#EE7A4F;font-weight:bold;">网站资讯栏目</a>显示网站<a style="color:#EE7A4F;font-weight:bold;">最后更新时间</a>为很久之前)，咕咕建议你可以尝试<strong>刷新浏览器缓存</strong>再进行观看！</p><p style="margin-bottom:10px;"><strong style="font-size:16px;">Windows/Linux</strong>：请按下 <a style="color:#EE7A4F;font-weight:bold;">Ctrl + F5</a> 或 <a style="color:#EE7A4F;font-weight:bold;">Ctrl + Shift + R</a></p><p style="margin-bottom:10px;"><strong style="font-size:16px;">Mac</strong>：请按下 <a style="color:#EE7A4F;font-weight:bold;">Cmd + Shift + R</a></p><p style="margin-bottom:20px;">吸取之前博客无法访问的教训，以后分享的内容也会同步更新在另一个博客——<a target="_blank" rel="noopener external nofollow noreferrer" href="https://iwanlab.com" style="color:#EE7A4F;font-weight:bold;">爱玩实验室</a></p><p style="font-size:14px; color:#EE7A4F;font-weight:bold;">欢迎大家关注～</p></div></div></div><div class="card-widget"><div class="item-headline"><i class="fas fa-server"></i><span>高性价比服务器</span></div><div class="item-content"><a href="https://gao.ee/rn-banner" rel="external nofollow noreferrer" target="_blank"> <img src="https://loll.cc/rnbanner" alt="高性价比服务器racknerd" style="width:100%; height:auto;"> </a><a href="/archives/vps-cloudcone/" target="_blank"> <img src="https://loll.cc/ccpic" alt="高性价比服务器cloudcone" style="width:100%; height:auto;"> </a></div></div><div class="card-widget"><div class="item-headline"><i class="fas fa-credit-card"></i><span>加密货币Master卡</span></div><div class="item-content"><a href="/archives/onekey-card-tutorial" target="_blank"> <img src="https://gao.ee/pic-onekey" alt="OneKey虚拟卡" style="width:100%; height:auto;"> </a><a href="https://blog.laoda.de/archives/chatgpt-plus-depay/" target="_blank"> <img src="https://gao.ee/pic-depay" alt="Dupay虚拟卡" style="width:100%; height:auto;"> </a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-text">介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9"><span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9"><span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E9%A1%B9%E7%9B%AE%E5%B1%95%E7%A4%BA"><span class="toc-text">1. 项目展示</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83"><span class="toc-text">2. 搭建环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%90%AD%E5%BB%BA%E8%A7%86%E9%A2%91"><span class="toc-text">3. 搭建视频</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%90%AD%E5%BB%BA%E6%96%B9%E5%BC%8F"><span class="toc-text">4. 搭建方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%BC%80%E5%A7%8B%E6%90%AD%E5%BB%BA%EF%BC%88%E4%BB%A5%E5%AE%9D%E5%A1%94%E5%AE%89%E8%A3%85%E4%B8%BA%E4%BE%8B%E5%AD%90%EF%BC%89"><span class="toc-text">5. 开始搭建（以宝塔安装为例子）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%AE%89%E5%85%A8%E4%B8%8E%E8%AE%BE%E7%BD%AE%E8%AD%A6%E5%91%8A%E6%8E%92%E9%94%99%EF%BC%88%E9%87%8D%E7%82%B9%EF%BC%8C%E9%80%82%E7%94%A8%E4%BA%8E%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%EF%BC%89"><span class="toc-text">6. 安全与设置警告排错（重点，适用于宝塔面板）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-Nextcloud%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-text">6.1 Nextcloud性能优化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-1-%E4%BD%BF%E7%94%A8APCu%E5%92%8CRedis%E5%86%85%E5%AD%98%E7%BC%93%E5%AD%98"><span class="toc-text">6.1.1 使用APCu和Redis内存缓存</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-2-%E5%BC%80%E5%90%AFPHP-OPcache"><span class="toc-text">6.1.2 开启PHP OPcache</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-3-%E5%AE%98%E6%96%B9%E6%8E%A8%E8%8D%90%E7%9A%84PHP%E6%89%A9%E5%B1%95"><span class="toc-text">6.1.3 官方推荐的PHP扩展</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-4-%E6%96%87%E4%BB%B6%E6%89%AB%E6%8F%8F"><span class="toc-text">6.1.4 文件扫描</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-5-%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1%E4%BC%98%E5%8C%96"><span class="toc-text">6.1.5 后台任务优化</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E5%AE%89%E5%85%A8%E5%8F%8A%E8%AE%BE%E7%BD%AE%E8%AD%A6%E5%91%8A%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5"><span class="toc-text">6.2 安全及设置警告问题排查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-Nextcloud%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98"><span class="toc-text">6.3 Nextcloud常见问题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-1-%E8%A7%A3%E5%86%B3%E5%A4%A7%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%97%AE%E9%A2%98"><span class="toc-text">6.3.1 解决大文件上传问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-2-%E8%A7%A3%E5%86%B3%E5%90%8C%E6%AD%A5%E6%97%B6423%E9%94%99%E8%AF%AF%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-text">6.3.2 解决同步时423错误的问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-3-Nextcloud%E9%80%80%E5%87%BA%E7%BB%B4%E6%8A%A4%E6%A8%A1%E5%BC%8F"><span class="toc-text">6.3.3 Nextcloud退出维护模式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Nextcloud%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-text">7. Nextcloud基本使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-Nextcloud%E5%9F%BA%E6%9C%AC%E8%AE%BE%E7%BD%AE"><span class="toc-text">7.1 Nextcloud基本设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-Nextcloud%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-text">7.2 Nextcloud客户端</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-Nextcloud%E7%9A%84WebDAV%E5%8A%9F%E8%83%BD"><span class="toc-text">7.3 Nextcloud的WebDAV功能</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E7%BB%93%E5%B0%BE"><span class="toc-text">8. 结尾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-text">参考资料</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%99%84%EF%BC%9A"><span class="toc-text">附：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E5%86%85%E9%83%A8%E9%94%99%E8%AF%AF%E5%92%8C%E8%AD%A6%E5%91%8A%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95"><span class="toc-text">1、内部错误和警告的解决方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81PHP%E6%A8%A1%E5%9D%97%E9%97%AE%E9%A2%98"><span class="toc-text">2、PHP模块问题</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/archives/cloudflare-tunnel/" title="无惧DDOS，无需开放额外端口，无需服务器，随时随地访问局域网Web应用——Cloudflare Tunnel"><img src="https://img.laoda.de/i/2023/09/09/xesejx-0.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无惧DDOS，无需开放额外端口，无需服务器，随时随地访问局域网Web应用——Cloudflare Tunnel"/></a><div class="content"><a class="title" href="/archives/cloudflare-tunnel/" title="无惧DDOS，无需开放额外端口，无需服务器，随时随地访问局域网Web应用——Cloudflare Tunnel">无惧DDOS，无需开放额外端口，无需服务器，随时随地访问局域网Web应用——Cloudflare Tunnel</a><time datetime="2023-09-09T12:18:19.000Z" title="发表于 2023-09-09 20:18:19">2023-09-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/docker-compose-install-nextcloud-aio/" title="【好玩儿的Docker项目】Nextcloud All-in-One 全新搭建分享，拒绝繁琐配置，开箱即用！维护简单！"><img src="https://img.laoda.de/i/2023/08/26/f9ju6v-0.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【好玩儿的Docker项目】Nextcloud All-in-One 全新搭建分享，拒绝繁琐配置，开箱即用！维护简单！"/></a><div class="content"><a class="title" href="/archives/docker-compose-install-nextcloud-aio/" title="【好玩儿的Docker项目】Nextcloud All-in-One 全新搭建分享，拒绝繁琐配置，开箱即用！维护简单！">【好玩儿的Docker项目】Nextcloud All-in-One 全新搭建分享，拒绝繁琐配置，开箱即用！维护简单！</a><time datetime="2023-08-26T01:20:35.000Z" title="发表于 2023-08-26 09:20:35">2023-08-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/hetzner-dedicated-sb/" title="Hetzner独立服务器（拍卖机）测评及折腾不完全指南"><img src="https://img.laoda.de/i/2023/08/24/uawlo1-0.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hetzner独立服务器（拍卖机）测评及折腾不完全指南"/></a><div class="content"><a class="title" href="/archives/hetzner-dedicated-sb/" title="Hetzner独立服务器（拍卖机）测评及折腾不完全指南">Hetzner独立服务器（拍卖机）测评及折腾不完全指南</a><time datetime="2023-08-24T10:00:30.000Z" title="发表于 2023-08-24 18:00:30">2023-08-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/docker-compose-install-plausible/" title="【好玩儿的Docker项目】Umami替代品，又一款网站流量统计工具——Plausible"><img src="https://img.laoda.de/i/2023/08/13/lv77r3-0.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【好玩儿的Docker项目】Umami替代品，又一款网站流量统计工具——Plausible"/></a><div class="content"><a class="title" href="/archives/docker-compose-install-plausible/" title="【好玩儿的Docker项目】Umami替代品，又一款网站流量统计工具——Plausible">【好玩儿的Docker项目】Umami替代品，又一款网站流量统计工具——Plausible</a><time datetime="2023-08-13T04:37:21.000Z" title="发表于 2023-08-13 12:37:21">2023-08-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/aws-free/" title="免费12个月使用！体验AWS——目前世界上最大的云服务器提供商家！（含DD教程）"><img src="https://img.laoda.de/i/2023/08/03/znrisx-0.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="免费12个月使用！体验AWS——目前世界上最大的云服务器提供商家！（含DD教程）"/></a><div class="content"><a class="title" href="/archives/aws-free/" title="免费12个月使用！体验AWS——目前世界上最大的云服务器提供商家！（含DD教程）">免费12个月使用！体验AWS——目前世界上最大的云服务器提供商家！（含DD教程）</a><time datetime="2023-08-03T13:55:12.000Z" title="发表于 2023-08-03 21:55:12">2023-08-03</time></div></div></div></div><div class="card-widget ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8920495929686095" data-ad-slot="6466840699" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div></main><footer id="footer" style="background-image: url('https://img.laoda.de/i/2022/05/02/dzx54l_7.webp')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 咕咕鸽</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">本站点由<a href="https://gao.ee/foot-link-bwg" rel="external nofollow noreferrer" target="_blank" style="font-weight:bold; color:#F4CA46;">搬瓦工</a>提供云服务</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (true){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>function loadWaline () {
  function initWaline () {
    const waline = Waline.init(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://waline.gugu.ee',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      path: window.location.pathname,
      comment: false,
    }, null))
  }

  if (typeof Waline === 'object') initWaline()
  else {
    getCSS('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.css').then(() => {
      getScript('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.js').then(initWaline)
    })
  }
}

if ('Waline' === 'Waline' || !true) {
  if (true) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
  else setTimeout(loadWaline, 0)
} else {
  function loadOtherComment () {
    loadWaline()
  }
}</script><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://talk.gugu.ee/',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://talk.gugu.ee/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.textContent = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Waline' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>